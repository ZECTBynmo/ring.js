<% def name="yop" %>
    Hello
<% def %>
<% def name="test" %>
    ${test_var}
<% def %>
<% def name="test2" %>
    <% _.each(lst, function(el) { %>
    ${el}
    <% }
    ); %>
<% def %>
<% def name="test3" %>
    % _.each(lst, function(el) { 
    ${el}
    % }); 
<% def %>
<% def name="testfct" %>
    % var yop = function(arg) {
    ${arg}
    % }; 
    <% yop("abc"); %>
    % yop("def");
<% def %>
<% def name="testmacro" %>
    lalala
<% def %>
<% def name="testcallmacro" %>
    %{engine.testmacro()}
<% def %>
<% def name="testescaping" %>
    % var x = "<div></div>";
    ${x}
<% def %>
<% def name="testnoescaping" %>
    % var x = "<div></div>";
    %{x}
<% def %>
<% def name="test_this" %>
    ${this.str}
<% def %>
<% def name="functional_prog_caller" %>
    % var x = function() {
        <span>test</span>
    % };
    %{engine.functional_prog_callee({x: x})}
<% def %>
<% def name="functional_prog_callee" %>
    <div>
        %{x()}
    </div>
<% def %>


